.PHONY: all pdf mps clean

mkdir -p mps

mps_files = {% for i in range(animation.duration*animation.ips+1) %}mps/frame_{{i}}.mps {% endfor %}

rm -f storylclib
ln -s {{libdir}}/storylclib storylclib

rm -f mounted
ln -s {{srcdir}} mounted

$(mps_files) : animation.mp
    mpost --tex=latex $<

mps : $(mps_files)

pdf : animation.pdf

animation.pdf : animation.tex $(mps_files)
    lualatex animation.tex

clean:
    rm -f $(mps_files) animation.pdf
